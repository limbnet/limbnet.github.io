var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,k){a!=Array.prototype&&a!=Object.prototype&&(a[c]=k.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var c,k=[];!(c=a.next()).done;)k.push(c.value);return k};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
(function(){function a(a){g&&(cancelAnimationFrame(g),g=void 0);requestAnimationFrame(function(f){document.getElementById("timeSlider").value=a;k(a,d)})}function c(f,e,m){f=void 0===f?10:f;e=void 0===e?0:e;m=void 0===m?d.morphomovie.length:m;a(e);e<m-1&&(g=requestAnimationFrame(function(a){c(f,e+1,m)}))}function k(a,e){a=void 0===a?0:a;tp=e.morphomovie[a];nodes=tp.verts;numNodes=nodes.length;elements=tp.tris;numElements=elements.length;canvas=document.getElementById("mainDrawing");ctx=canvas.getContext("2d");
ctx.fillStyle="#888888";ctx.fillRect(0,0,canvas.width,canvas.height);concentrations=tp.chem[u.species[t]];document.getElementById("timePoint").innerHTML=Math.round(tp.t);w=a;ctx.strokeStyle="none";for(var f=ctx.lineWidth=0;f<numElements;f++){ctx.beginPath();var d=elements[f],c=nodes[d[0]-1],b=nodes[d[1]-1],d=nodes[d[2]-1];ctx.moveTo((v+c[0])*l,.5*canvas.height-l*c[1]);ctx.lineTo((v+b[0])*l,.5*canvas.height-l*b[1]);ctx.lineTo((v+d[0])*l,.5*canvas.height-l*d[1]);ctx.closePath();ctx.fillStyle="rgb("+
Math.round(255*concentrations[f]).toString()+", 0, 0)";ctx.fill()}}console.log("Initialising morphomovie experiment...");var u={species:{sim_sox9:0,sim_wnt:1,sim_bmp:2,fgf8sig:3,hoxd13:4,smad:5}},d={},n=document.getElementById("timeSlider");n.min=0;n.max=0;n.addEventListener("input",function(){a(n.value)});var p=new XMLHttpRequest;p.open("GET","data/test-rasmar.blob",!0);p.responseType="arraybuffer";p.onreadystatechange=function(){if(4===this.readyState&&200==this.status){var a=new DataStream(p.response);
a.endianness=a.BIG_ENDIAN;d=a.readStruct(["morphomovie",["[]",["t","float32","nVerts","int32","verts",["[]",["[]","float32",2],function(a,d){return a.nVerts-1}],"nTris","int32","tris",["[]",["[]","int32",3],"nTris"],"nChem","int32","chem",["[]",["[]","float32","nTris"],"nChem"]],"*"]]);for(a=0;a<d.morphomovie.length;a++)for(var e=0;e<d.morphomovie[a].chem.length;e++){var c=Math.min.apply(Math,[].concat($jscomp.arrayFromIterable(d.morphomovie[a].chem[e])));var b=Math.max.apply(Math,[].concat($jscomp.arrayFromIterable(d.morphomovie[a].chem[e])));
b=c===b?0:1/(b-c);for(var h=0;h<d.morphomovie[a].chem[e].length;h++)d.morphomovie[a].chem[e][h]=b*(d.morphomovie[a].chem[e][h]-c)}n.max=d.morphomovie.length-1;requestAnimationFrame(function(a){k(0,d)})}};p.send();console.log("Request XHR blob.");var w=0,g=0,t=Object.getOwnPropertyNames(u.species)[0],q=[],b=document.createElement("BUTTON");b.onclick=function(){a(0)};var r=document.createTextNode("|<<");b.appendChild(r);q.push(b);b=document.createElement("BUTTON");b.onclick=function(){g?(cancelAnimationFrame(g),
g=void 0):g=requestAnimationFrame(function(a){c()})};r=document.createTextNode("Animate");b.appendChild(r);q.push(b);b=document.createElement("BUTTON");b.onclick=function(){a(d.morphomovie.length-1)};r=document.createTextNode(">>|");b.appendChild(r);q.push(b);document.getElementById("speciesList").appendChild(function(a){for(var c=document.createElement("ul"),b=0;b<a.length;b++){var f=document.createElement("li"),h=document.createElement("BUTTON");a[b]===t&&(h.style.border="1px solid #f44336");h.id=
"but_"+a[b];h.onclick=function(a){return function(){console.log("Drawing: "+a);document.getElementById("but_"+t).style.border="";t=a;this.style.border="1px solid #f44336";requestAnimationFrame(function(a){k(w,d)})}}(a[b]);var g=document.createTextNode(a[b]);h.appendChild(g);f.appendChild(h);c.appendChild(f)}return c}(Object.getOwnPropertyNames(u.species)));for(bi=0;bi<q.length;bi++)document.getElementById("timeControls").appendChild(q[bi]);var l=.15,v=450})();

